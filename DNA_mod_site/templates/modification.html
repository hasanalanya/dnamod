<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset = "UTF-8">
    <title>DNA Modification Database: {{ ChebiName }}</title>

    <script type="text/javascript" src="https://code.jquery.com/jquery-2.1.4.min.js"></script>
    <link rel="stylesheet" href="https://ajax.googleapis.com/ajax/libs/jqueryui/1.11.4/themes/smoothness/jquery-ui.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.11.4/jquery-ui.min.js"></script>
    
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap-theme.min.css" integrity="sha384-rHyoN1iRsVXV4nD0JutlnGaslCJuC7uwjduW9SVrLvRYooPp2bWYgmgJQIXwl/Sp" crossorigin="anonymous">
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>
    
    <link href="css/style.css" rel="stylesheet" type='text/css'>
    
</head>

<body id="modification">
    <div class= "TitleBlock" >
        <nav class="navbar navbar-custom navbar-fixed-top">
          <div class="container-fluid">
            <!-- Brand and toggle get grouped for better mobile display -->
            <div class="navbar-header">
              <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target=".navbar-collapse" aria-expanded="false">
                <span class="sr-only">Toggle navigation</span>
                <span class="glyphicon glyphicon-list"></span>
              </button>
              <p class="navbar-text">{{ ChebiName }}: DNAmod</p>
            </div>

            <!-- Collect the nav links, forms, and other content for toggling -->
            <div class="collapse navbar-collapse">
              <div class="nav navbar-nav navbar-right">
                <p class="navbar-text">A modification of <a href= "https://www.ebi.ac.uk/chebi/searchId.do?chebiId={{ ParentLink }}" > {{ CommonName }} </a></p>
              </div>
            </div><!-- /.navbar-collapse -->
          </div><!-- /.container-fluid -->
        </nav>
    </div>
    
    <!-- TODO refactor to infer headers from dict -->
    <div class="container-fluid">
    
        <div class="row">
        
            <div class="col-xs-12 col-md-6">
                {% if Definition or Formula or NetCharge or AverageMass %}
                    <div class="panel panel-default">
                        <div class="panel-body">
                    
                            <div class="BasicInfo">
                                {% if Definition %}
                                    <h2 rel="tooltip" title="Lorem ipsum dolor sit amet, consectetur adipiscing elit. Maecenas bibendum ac felis id commodo. Etiam mauris purus, fringilla id tempus in, mollis vel orci. Duis ultricies at erat eget iaculis."> Description: </h2>
                                    <p> {{ Definition }} </p>
                                {% endif %}

                                {% if Formula or NetCharge or AverageMass %}
                                    <h2 rel="tooltip" title="Lorem ipsum dolor sit amet, consectetur adipiscing elit. Maecenas bibendum ac felis id commodo. Etiam mauris purus, fringilla id tempus in, mollis vel orci. Duis ultricies at erat eget iaculis."> Chemical properties: </h2>
                                    <table class="table table-striped" id="ChemProps">
                                        <tr>
                                            <th> Chemical formula </th>
                                            <th> Net charge </th>
                                            <th> Average mass </th>
                                        </tr>
                                        <tr>
                                            <td> {% if Formula %}{{ Formula }}{% endif %} </td>
                                            <td> {% if NetCharge %}{{ NetCharge }}{% endif %} </td>
                                            <td> {% if AverageMass %}{{ AverageMass }}{% endif %} </td>
                                        </tr>
                                    </table>
                                {% endif %}
                            </div>
                            
                        </div>
                    </div>
                {% endif %}
            </div>
                        
            <div class="col-xs-12 col-md-6">
                {% if Image or ExpandedAlpha %}
                    <div class="panel panel-default">
                        <div class="panel-body">

                            {% if Image %}
                                <div class="col-sm-6">
                                    <img id="chemicalStructureImage" src="{{ Image }}" alt="{{ ChebiName }}" height='250' width='250'>
                                </div>
                            {% endif %} 
            
                            {% if ExpandedAlpha %}
                                <div class="ExpandedAlpha">
                                    <div class="col-sm-6">
                                        <h2 rel="tooltip" title="Lorem ipsum dolor sit amet, consectetur adipiscing elit. Maecenas bibendum ac felis id commodo. Etiam mauris purus, fringilla id tempus in, mollis vel orci. Duis ultricies at erat eget iaculis."> Recommended notation: </h2>
                                        <table>
                                            <tr>
                                                <th> Name </th>
                                                <td> {{ ExpandedAlpha["Name"] }} </td> 
                                            <tr>
                                                <th> Abbreviation </th>
                                                <td> {{ ExpandedAlpha["Abbreviation"] }} </td>
                                            </tr>
                                            {% if ExpandedAlpha["Symbol"] %}
                                                <tr>
                                                    <th> Symbol </th>
                                                    <td class="nucleobase"> {{ ExpandedAlpha["Symbol"] }} </td>
                                                </tr>
                                            {% endif %}
                                            {% if ExpandedAlpha["Complement Symbol"] %}
                                                <tr>
                                                    <th> Complement </th>
                                                    <td> {{ ExpandedAlpha["Complement"] }} </td>
                                                </tr>
                                                <tr>
                                                    <th> Symbol </th>
                                                    <td class="nucleobase"> {{ ExpandedAlpha["Complement Symbol"] }} </td>
                                                </tr>
                                            {% endif %}
                                        </table>
                                    </div>
                                </div>
                            {% endif %}
                        
                        </div>
                    </div>
                {% endif %}
            </div>
                         
        </div>

        <div class="row">
            
                <div class="col-xs-12">
                    {% if IupacName or Smiles or Synonyms %}
                        <div class="panel panel-default">
                            <div class="panel-body">
                                <div class="Names">
                                    {% if IupacName or Smiles or Synonyms %}
                                        <h2 id="Inline" rel="tooltip" title="Lorem ipsum dolor sit amet, consectetur adipiscing elit. Maecenas bibendum ac felis id commodo. Etiam mauris purus, fringilla id tempus in, mollis vel orci. Duis ultricies at erat eget iaculis."> Nomenclature: </h2>
                                        <div class="table-responsive">
                                            <table class="table table-striped" id="Names">
                                                <tr>
                                                    {% if IupacName %}<th> IUPAC </th>{% endif %}
                                                    {% if Smiles %}<th> SMILES </th>{% endif %}
                                                    {% if Synonyms|length %}
                                                        <th> Synonyms </th>
                                                    {% endif %}
                                                </tr>
                                                <tr>
                                                    {% if IupacName %}<td> {{ IupacName }} </td>{% endif %}
                                                    {% if Smiles %}<td> {{ Smiles }} </td>{% endif %}
                                                    {% if Synonyms|length %}
                                                        <td>
                                                            <ul id="Synonyms">
                                                            {% for Synonym in Synonyms %}
                                                                <li> {{ Synonym }} </li>
                                                            {% endfor %}
                                                        </td>
                                                    {% endif %}
                                                </tr>
                                            </table>
                                        </div>
                                    {% endif %}
                                </div>
                            </div>
                        </div>
                    {% endif %}
                </div>
            
            </div>
            
        <div class="row">
                    
            {% for RefAnnot in RefAnnots %}
                {% if RefAnnot|length %}  <!-- not in for to ensure counter still increments -->
                
                    <div class="col-xs-12">
                        <div class="panel panel-default">
                            <div class="panel-body">
                            
                                <div class="RefAnnotTable" {{ RefAnnotTabNames[loop.index0] }}>
                                    <h2 id="Inline" rel="tooltip" title="Lorem ipsum dolor sit amet, consectetur adipiscing elit. Maecenas bibendum ac felis id commodo. Etiam mauris purus, fringilla id tempus in, mollis vel orci. Duis ultricies at erat eget iaculis."> {{ RefAnnotTabNames[loop.index0] }}: </h2>
                                    <div class="table-responsive">
                                        <table class="table table-striped" id={{ RefAnnotTabNames[loop.index0] }}>
                                            <tr>
                                                {% for Header, _ in RefAnnot[0].iteritems() if Header not in RefAnnotsRefColNames %}
                                                    <th> {{ Header }} </th>
                                                {% endfor %}
                                                <th> Reference(s) </th>
                                            </tr>
                                            <tr>
                                                <!-- XXX refactor to use common ref. print scheme WRT below... -->
                                                {% for RefAnnotEntry in RefAnnot %}
                                                    {% for _, Data in RefAnnotEntry.iteritems() if _ not in RefAnnotsRefColNames %}
                                                        <td 
                                                            {% set ListDataToUse = Data.split(',') %}    
                                                        {% if 'organism' in _.lower() or 'species' in _.lower() %}
                                                            class="species"
                                                            {% set ListDataToUse = ListDataToUse | sort %}
                                                        {% endif %}
                                                        >
                                                        {% if ',' in Data and 'and' not in Data %} <!-- -->
                                                                <ul>
                                                                    {% for Datum in ListDataToUse %}
                                                                        <li> {{ Datum }} </li>
                                                                    {% endfor %}
                                                                </ul>
                                                            {% else %}
                                                                {{ Data }}
                                                            {% endif %}
                                                        </td>
                                                    {% endfor %}
            
                                                    {% if RefAnnotEntry["citationid"] %}
                                                        {% set AuthorL = RefAnnotEntry["authors"].split(';') %}
                                                        {% set TitleL = RefAnnotEntry["title"].split(';') %}
                                                        {% set PubdateL = '' %}
                                                        {% if RefAnnotEntry["pubdate"] %}
                                                            {% set PubdateL = RefAnnotEntry["pubdate"].split(';') %}
                                                        {% endif %}

                                                        <!-- TODO refactor citation format... -->
                                                        <td>
                                                            <ul>
                                                                {% for citationid in RefAnnotEntry["citationid"].split(';') %}
                                                                    <li> {{ AuthorL[loop.index0] }} <a href= 'http://www.ncbi.nlm.nih.gov/pubmed/?term={{ citationid }}' > {{ TitleL[loop.index0] | replace('.', '') }}</a>.  {% if PubdateL and PubdateL[loop.index0] %} {{ PubdateL[loop.index0] }}. {% endif %} </li>
                                                                {% endfor %}
                                                            </ul>
                                                        </td>
                                                    {% endif %}
                                                </tr>
                                            {% endfor %}
                                        </table>
                                    </div>
                                </div>
                                
                            </div>
                        </div>
                    </div>
                    
                {%endif %}
            {% endfor %}
            
        </div>
                
        <div class="Links">
        
            <div class="row">
                <div class="col-xs-12">
                    <div class="panel panel-default">
                        <div class="panel-body">
                            <h2 id="Inline"> Database references: </h2> 
                            <a id="Inline" href= "https://www.ebi.ac.uk/chebi/searchId.do?chebiId={{ ChebiId }}" > {{ ChebiId }} </a> <br>
                        </div>
                    </div>
                </div>
            </div>

            {% if Citations|length %}
                <div class="row">
                    <div class="col-xs-12">
                        <div class="panel panel-default">
                            <div class="panel-body">
                            
                                <h2> Citations: </h2>
                                <ul class="list-group" id="Citations">
                                    {% if Citations|length %}
                                        {% for Citation in Citations %}
                                        <li class="list-group-item">{{ Citation["authors"] }} <a href= 'http://www.ncbi.nlm.nih.gov/pubmed/?term={{ Citation["citationid"] }}' > {{ Citation["title"] }} </a> {% if Citation["pubdate"] %} {{ Citation["pubdate"] }}. {% endif %}  </li>
                                        {% endfor %}
                                    {% else %}
                                        <li> No Citations </li>
                                    {% endif %}
                                </ul>
                                
                            </div>
                        </div>
                    </div>
                </div>
            {% endif %}
            
        </div>
        
    </div>
</body>

<footer class="footer">
        <nav class="navbar navbar-custom navbar-fixed-bottom center">
            <div class="navbar-inner">
                <ul class="nav navbar-nav">
                    <li><a href= "index.html"> Home</a></li>
                    <li><a href= "about.html"> About</a></li>
                    <li><a href= "contact.html"> Contact</a></li>
                </ul>
            </div> 
        </nav>
</footer>

</html>
